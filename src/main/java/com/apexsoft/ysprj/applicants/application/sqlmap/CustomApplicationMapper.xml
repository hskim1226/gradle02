<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.apexsoft.ysprj.applicants.application.sqlmap.CustomApplicationMapper" >
    <resultMap id="BaseResultMap" type="com.apexsoft.ysprj.applicants.application.domain.Application" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        <id column="APPL_NO" property="applNo" jdbcType="INTEGER" />
        <result column="USER_ID" property="userId" jdbcType="VARCHAR" />
        <result column="ADMS_NO" property="admsNo" jdbcType="VARCHAR" />
        <result column="DEPT_CODE" property="deptCode" jdbcType="VARCHAR" />
        <result column="ARI_INST_CODE" property="ariInstCode" jdbcType="VARCHAR" />
        <result column="CORS_TYPE_CODE" property="corsTypeCode" jdbcType="VARCHAR" />
        <result column="DETL_MAJ_CODE" property="detlMajCode" jdbcType="VARCHAR" />
        <result column="INP_DETL_MAJ" property="inpDetlMaj" jdbcType="VARCHAR" />
        <result column="PART_TIME_YN" property="partTimeYn" jdbcType="VARCHAR" />
        <result column="KOR_NAME" property="korName" jdbcType="VARCHAR" />
        <result column="CHN_NAME" property="chnName" jdbcType="VARCHAR" />
        <result column="ENG_SUR" property="engSur" jdbcType="VARCHAR" />
        <result column="ENG_NAME" property="engName" jdbcType="VARCHAR" />
        <result column="RGST_NO" property="rgstNo" jdbcType="VARCHAR" />
        <result column="RGST_BORN_DATE" jdbcType="VARCHAR" property="rgstBornDate" />
        <result column="RGST_ENCR" jdbcType="VARCHAR" property="rgstEncr" />
        <result column="ZIP_CODE" property="zipCode" jdbcType="VARCHAR" />
        <result column="ADDR" property="addr" jdbcType="VARCHAR" />
        <result column="DETL_ADDR" property="detlAddr" jdbcType="VARCHAR" />
        <result column="TEL_NUM" property="telNum" jdbcType="VARCHAR" />
        <result column="MOBI_NUM" property="mobiNum" jdbcType="VARCHAR" />
        <result column="FAX_NUM" property="faxNum" jdbcType="VARCHAR" />
        <result column="MAIL_ADDR" property="mailAddr" jdbcType="VARCHAR" />
        <result column="APPL_ID" property="applId" jdbcType="VARCHAR" />
        <result column="APPL_STS_CODE" property="applStsCode" jdbcType="VARCHAR" />
        <result column="PRIV_INFO_YN" property="privInfoYn" jdbcType="VARCHAR" />
        <result column="CRE_ID" property="creId" jdbcType="VARCHAR" />
        <result column="CRE_DATE" property="creDate" jdbcType="DATE" />
        <result column="MOD_ID" property="modId" jdbcType="VARCHAR" />
        <result column="MOD_DATE" property="modDate" jdbcType="DATE" />
    </resultMap>

    <sql id="Base_Column_List" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        APPL_NO, USER_ID, ADMS_NO, DEPT_CODE, ARI_INST_CODE, CORS_TYPE_CODE, DETL_MAJ_CODE,
        INP_DETL_MAJ, PART_TIME_YN, KOR_NAME, CHN_NAME, ENG_SUR, ENG_NAME, RGST_NO, RGST_BORN_DATE, RGST_ENCR, ZIP_CODE,
        ADDR, DETL_ADDR, TEL_NUM, MOBI_NUM, FAX_NUM, MAIL_ADDR, APPL_ID, APPL_STS_CODE, PRIV_INFO_YN,
        CRE_ID, CRE_DATE, MOD_ID, MOD_DATE
    </sql>

    <select id="selectApplForInsertOthers" resultMap="BaseResultMap" parameterType="com.apexsoft.ysprj.applicants.application.domain.ParamForInitialApply" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        select
        <include refid="Base_Column_List" />
        from APPL
        where USER_ID = #{userId,jdbcType=VARCHAR}
          and ADMS_NO = #{admsNo,jdbcType=VARCHAR}
          and APPL_STS_CODE = #{applStsCode,jdbcType=VARCHAR}
    </select>

    <select id="selectApplByApplForInsertOthers"
            resultType="com.apexsoft.ysprj.applicants.application.domain.Application"
            parameterType="com.apexsoft.ysprj.applicants.application.domain.Application" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        select
        *
        from APPL
        where USER_ID = #{userId}
        and ADMS_NO = #{admsNo}
        and ENTR_YEAR = #{entrYear}
        and ADMS_TYPE_CODE = #{admsTypeCode}
        and APPL_ATTR_CODE = #{applAttrCode}
        and DEPT_CODE = #{deptCode}
        and ARI_INST_CODE = #{ariInstCode}
        and CORS_TYPE_CODE = #{corsTypeCode}
        and DETL_MAJ_CODE = #{detlMajCode}
        <!--and INP_DETL_MAJ = #{inpDetlMaj}-->
        <!--and PART_TIME_YN = #{partTimeYn}-->
        <!--and KOR_NAME = #{korName}-->
        <!--and CHN_NAME = #{chnName}-->
        <!--and ENG_SUR = #{engSur}-->
        <!--and ENG_NAME = #{engName}-->
        <!--and RGST_NO = #{rgstNo}-->
        <!--and ZIP_CODE = #{zipCode}-->
        <!--and ADDR = #{addr}-->
        <!--and DETL_ADDR = #{detlAddr}-->
        <!--and TEL_NUM = #{telNum}-->
        <!--and MOBI_NUM = #{mobiNum}-->
        <!--and FAX_NUM = #{faxNum}-->
        <!--and MAIL_ADDR = #{mailAddr}-->
        <!--and APPL_ID = #{applId}-->
        <!--and APPL_STS_CODE = #{applStsCode}-->
        <!--and PRIV_INFO_YN = #{privInfoYn}-->
        <!--and CRE_ID = #{creId}-->
        and CRE_DATE = #{creDate}
        <!--and MOD_ID = #{modId}-->
        <!--and MOD_DATE = #{modDate}-->
    </select>

    <select id="selectApplByUserId"
            resultType="com.apexsoft.ysprj.applicants.application.domain.CustomMyList"
            parameterType="com.apexsoft.ysprj.applicants.application.domain.ParamForApplication" >
        select  a.APPL_NO, a.ADMS_NO, a.ENTR_YEAR, a.ADMS_TYPE_CODE,
                a.USER_ID, a.KOR_NAME,
                a.ADMS_TYPE_CODE, H.CODE_VAL ADMS_TYPE_NAME,
                F.CAMP_NAME, a.DEPT_CODE, b.DEPT_NAME,
                a.CORS_TYPE_CODE, G.CODE_VAL CORS_TYPE_NAME,
                a.DETL_MAJ_CODE, C.DETL_MAJ_NAME,
                a.APPL_STS_CODE, I.CODE_VAL APPL_STS_NAME,
                J.ADMS_FEE
        from  APPL a, DEPT b, DETL_MAJ C, COLL e, CAMP F, COMM_CODE G, COMM_CODE H, COMM_CODE I, ADMS_CORS J
        where 1=1
        AND a.DEPT_CODE = b.DEPT_CODE
        AND b.COLL_CODE= e.COLL_CODE
        AND e.CAMP_CODE = F.CAMP_CODE
        AND a.DETL_MAJ_CODE = C.DETL_MAJ_CODE
        AND a.CORS_TYPE_CODE = G.CODE
        AND a.ADMS_TYPE_CODE= H.CODE
        AND a.APPL_STS_CODE= I.CODE
        AND G.CODE_GRP='CORS_TYPE'
        AND H.CODE_GRP='ADMS_TYPE'
        AND I.CODE_GRP='APPL_STS'
        AND a.ADMS_NO=J.ADMS_NO
        AND a.DEPT_CODE=J.DEPT_CODE
        AND IFNULL(a.ARI_INST_CODE,'') = IFNULL(J.ARI_INST_CODE,'')
        AND a.CORS_TYPE_CODE = J.CORS_TYPE_CODE
        AND a.APPL_STS_CODE NOT IN ('00022', '00040')
        AND a.USER_ID =#{userId}
        order by a.CRE_DATE
    </select>

    <select id="selectNewSeq" resultType="com.apexsoft.ysprj.applicants.application.domain.CustomNewSeq" parameterType="int">
        select a.ADMS_NO as ADMS_NO,
            a.DEPT_CODE as DEPT_CODE,
            a.CORS_TYPE_CODE as CORS_TYPE_CODE,
            max(APPL_ID_SEQ)+1 as NEW_SEQ
        from APPL a, APPL_ID_SEQ b
        where a.ADMS_NO = b.ADMS_NO
        and a.DEPT_CODE = b.DEPT_CODE
        and a.CORS_TYPE_CODE = b.CORS_TYPE_CODE
        and a.APPL_NO = #{applNo,jdbcType=INTEGER}
    </select>

    <update id="updateApplIdSeqIdByNewSeq" parameterType="com.apexsoft.ysprj.applicants.application.domain.CustomNewSeq">
        update APPL_ID_SEQ
        set APPL_ID_SEQ = #{newSeq,jdbcType=INTEGER}
        where ADMS_NO = #{admsNo,jdbcType=VARCHAR}
        and DEPT_CODE = #{deptCode,jdbcType=VARCHAR}
        and CORS_TYPE_CODE = #{corsTypeCode,jdbcType=VARCHAR}
    </update>

    <update id="updateApplByApplNo" parameterType="com.apexsoft.ysprj.applicants.application.domain.Application">
        update APPL
        set APPL_STS_CODE = '00020',
            APPL_ID = #{admsNo,jdbcType=VARCHAR}
        where APPL_NO = #{applNo,jdbcType=INTEGER}
    </update>

    <insert id="insertSelective" parameterType="com.apexsoft.ysprj.applicants.application.domain.Application">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Sep 18 18:37:48 KST 2014.
        -->
        insert into APPL
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="applNo != null">
                APPL_NO,
            </if>
            <if test="userId != null">
                USER_ID,
            </if>
            <if test="admsNo != null">
                ADMS_NO,
            </if>
            <if test="entrYear != null">
                ENTR_YEAR,
            </if>
            <if test="admsTypeCode != null">
                ADMS_TYPE_CODE,
            </if>
            <if test="applAttrCode != null">
                APPL_ATTR_CODE,
            </if>
            <if test="fornTypeCode != null">
                FORN_TYPE_CODE,
            </if>
            <if test="campCode != null">
                CAMP_CODE,
            </if>
            <if test="collCode != null">
                COLL_CODE,
            </if>
            <if test="deptCode != null">
                DEPT_CODE,
            </if>
            <if test="ariInstCode != null">
                ARI_INST_CODE,
            </if>
            <if test="corsTypeCode != null">
                CORS_TYPE_CODE,
            </if>
            <if test="detlMajCode != null">
                DETL_MAJ_CODE,
            </if>
            <if test="inpDetlMaj != null">
                INP_DETL_MAJ,
            </if>
            <if test="partTimeYn != null">
                PART_TIME_YN,
            </if>
            <if test="korName != null">
                KOR_NAME,
            </if>
            <if test="chnName != null">
                CHN_NAME,
            </if>
            <if test="engSur != null">
                ENG_SUR,
            </if>
            <if test="engName != null">
                ENG_NAME,
            </if>
            <if test="rgstNo != null">
                RGST_NO,
            </if>
            <if test="rgstBornDate != null">
                RGST_BORN_DATE,
            </if>
            <if test="rgstEncr != null">
                RGST_ENCR,
            </if>
            <if test="citzCntrCode != null">
                CITZ_CNTR_CODE,
            </if>
            <if test="bornDay != null">
                BORN_DAY,
            </if>
            <if test="gend != null">
                GEND,
            </if>
            <if test="zipCode != null">
                ZIP_CODE,
            </if>
            <if test="addr != null">
                ADDR,
            </if>
            <if test="detlAddr != null">
                DETL_ADDR,
            </if>
            <if test="telNum != null">
                TEL_NUM,
            </if>
            <if test="mobiNum != null">
                MOBI_NUM,
            </if>
            <if test="faxNum != null">
                FAX_NUM,
            </if>
            <if test="mailAddr != null">
                MAIL_ADDR,
            </if>
            <if test="applId != null">
                APPL_ID,
            </if>
            <if test="applDate != null">
                APPL_DATE,
            </if>
            <if test="applStsCode != null">
                APPL_STS_CODE,
            </if>
            <if test="privInfoYn != null">
                PRIV_INFO_YN,
            </if>
            <if test="creId != null">
                CRE_ID,
            </if>
            <if test="creDate != null">
                CRE_DATE,
            </if>
            <if test="modId != null">
                MOD_ID,
            </if>
            <if test="modDate != null">
                MOD_DATE,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="applNo != null">
                #{applNo,jdbcType=INTEGER},
            </if>
            <if test="userId != null">
                #{userId,jdbcType=VARCHAR},
            </if>
            <if test="admsNo != null">
                #{admsNo,jdbcType=VARCHAR},
            </if>
            <if test="entrYear != null">
                #{entrYear,jdbcType=VARCHAR},
            </if>
            <if test="admsTypeCode != null">
                #{admsTypeCode,jdbcType=VARCHAR},
            </if>
            <if test="applAttrCode != null">
                #{applAttrCode,jdbcType=VARCHAR},
            </if>
            <if test="fornTypeCode != null">
                #{fornTypeCode,jdbcType=VARCHAR},
            </if>
            <if test="campCode != null">
                #{campCode,jdbcType=VARCHAR},
            </if>
            <if test="collCode != null">
                #{collCode,jdbcType=VARCHAR},
            </if>
            <if test="deptCode != null">
                #{deptCode,jdbcType=VARCHAR},
            </if>
            <if test="ariInstCode != null">
                #{ariInstCode,jdbcType=VARCHAR},
            </if>
            <if test="corsTypeCode != null">
                #{corsTypeCode,jdbcType=VARCHAR},
            </if>
            <if test="detlMajCode != null">
                #{detlMajCode,jdbcType=VARCHAR},
            </if>
            <if test="inpDetlMaj != null">
                #{inpDetlMaj,jdbcType=VARCHAR},
            </if>
            <if test="partTimeYn != null">
                #{partTimeYn,jdbcType=VARCHAR},
            </if>
            <if test="korName != null">
                #{korName,jdbcType=VARCHAR},
            </if>
            <if test="chnName != null">
                #{chnName,jdbcType=VARCHAR},
            </if>
            <if test="engSur != null">
                #{engSur,jdbcType=VARCHAR},
            </if>
            <if test="engName != null">
                #{engName,jdbcType=VARCHAR},
            </if>
            <if test="rgstNo != null">
                #{rgstNo,jdbcType=VARCHAR},
            </if>
            <if test="rgstBornDate != null">
                #{rgstBornDate,jdbcType=VARCHAR},
            </if>
            <if test="rgstEncr != null">
                #{rgstEncr,jdbcType=VARCHAR},
            </if>
            <if test="citzCntrCode != null">
                #{citzCntrCode,jdbcType=VARCHAR},
            </if>
            <if test="bornDay != null">
                #{bornDay,jdbcType=VARCHAR},
            </if>
            <if test="gend != null">
                #{gend,jdbcType=VARCHAR},
            </if>
            <if test="zipCode != null">
                #{zipCode,jdbcType=VARCHAR},
            </if>
            <if test="addr != null">
                #{addr,jdbcType=VARCHAR},
            </if>
            <if test="detlAddr != null">
                #{detlAddr,jdbcType=VARCHAR},
            </if>
            <if test="telNum != null">
                #{telNum,jdbcType=VARCHAR},
            </if>
            <if test="mobiNum != null">
                #{mobiNum,jdbcType=VARCHAR},
            </if>
            <if test="faxNum != null">
                #{faxNum,jdbcType=VARCHAR},
            </if>
            <if test="mailAddr != null">
                #{mailAddr,jdbcType=VARCHAR},
            </if>
            <if test="applId != null">
                #{applId,jdbcType=VARCHAR},
            </if>
            <if test="applDate != null">
                #{applDate,jdbcType=TIMESTAMP},
            </if>
            <if test="applStsCode != null">
                #{applStsCode,jdbcType=VARCHAR},
            </if>
            <if test="privInfoYn != null">
                #{privInfoYn,jdbcType=VARCHAR},
            </if>
            <if test="creId != null">
                #{creId,jdbcType=VARCHAR},
            </if>
            <if test="creDate != null">
                #{creDate,jdbcType=TIMESTAMP},
            </if>
            <if test="modId != null">
                #{modId,jdbcType=VARCHAR},
            </if>
            <if test="modDate != null">
                #{modDate,jdbcType=TIMESTAMP},
            </if>
        </trim>
        <selectKey resultType="int" keyProperty="applNo" order="AFTER">
            SELECT LAST_INSERT_ID() as applNo;
        </selectKey>
    </insert>

    <select id="selectAvailableApplNos" resultType="int" parameterType="java.lang.String">
        SELECT APPL_NO FROM APPL
        WHERE USER_ID = #{userId,jdbcType=VARCHAR}
    </select>
</mapper>