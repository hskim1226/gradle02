<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.apexsoft.ysprj.applicants.application.sqlmap.CustomApplicationMapper" >
    <resultMap id="BaseResultMap" type="com.apexsoft.ysprj.applicants.application.domain.Application" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        <id column="APPL_NO" property="applNo" jdbcType="INTEGER" />
        <result column="USER_ID" property="userId" jdbcType="VARCHAR" />
        <result column="ADMS_NO" property="admsNo" jdbcType="VARCHAR" />
        <result column="DEPT_CODE" property="deptCode" jdbcType="VARCHAR" />
        <result column="ARI_INST_CODE" property="ariInstCode" jdbcType="VARCHAR" />
        <result column="CORS_TYPE_CODE" property="corsTypeCode" jdbcType="VARCHAR" />
        <result column="DETL_MAJ_CODE" property="detlMajCode" jdbcType="VARCHAR" />
        <result column="INP_DETL_MAJ" property="inpDetlMaj" jdbcType="VARCHAR" />
        <result column="PART_TIME_YN" property="partTimeYn" jdbcType="VARCHAR" />
        <result column="KOR_NAME" property="korName" jdbcType="VARCHAR" />
        <result column="CHN_NAME" property="chnName" jdbcType="VARCHAR" />
        <result column="ENG_SUR" property="engSur" jdbcType="VARCHAR" />
        <result column="ENG_NAME" property="engName" jdbcType="VARCHAR" />
        <result column="RGST_NO" property="rgstNo" jdbcType="VARCHAR" />
        <result column="ZIP_CODE" property="zipCode" jdbcType="VARCHAR" />
        <result column="ADDR" property="addr" jdbcType="VARCHAR" />
        <result column="DETL_ADDR" property="detlAddr" jdbcType="VARCHAR" />
        <result column="TEL_NUM" property="telNum" jdbcType="VARCHAR" />
        <result column="MOBI_NUM" property="mobiNum" jdbcType="VARCHAR" />
        <result column="FAX_NUM" property="faxNum" jdbcType="VARCHAR" />
        <result column="MAIL_ADDR" property="mailAddr" jdbcType="VARCHAR" />
        <result column="APPL_ID" property="applId" jdbcType="VARCHAR" />
        <result column="APPL_STS_CODE" property="applStsCode" jdbcType="VARCHAR" />
        <result column="PRIV_INFO_YN" property="privInfoYn" jdbcType="VARCHAR" />
        <result column="CRE_ID" property="creId" jdbcType="VARCHAR" />
        <result column="CRE_DATE" property="creDate" jdbcType="DATE" />
        <result column="MOD_ID" property="modId" jdbcType="VARCHAR" />
        <result column="MOD_DATE" property="modDate" jdbcType="DATE" />
    </resultMap>

    <sql id="Base_Column_List" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        APPL_NO, USER_ID, ADMS_NO, DEPT_CODE, ARI_INST_CODE, CORS_TYPE_CODE, DETL_MAJ_CODE,
        INP_DETL_MAJ, PART_TIME_YN, KOR_NAME, CHN_NAME, ENG_SUR, ENG_NAME, RGST_NO, ZIP_CODE,
        ADDR, DETL_ADDR, TEL_NUM, MOBI_NUM, FAX_NUM, MAIL_ADDR, APPL_ID, APPL_STS_CODE, PRIV_INFO_YN,
        CRE_ID, CRE_DATE, MOD_ID, MOD_DATE
    </sql>

    <select id="selectApplForInsertOthers" resultMap="BaseResultMap" parameterType="com.apexsoft.ysprj.applicants.application.domain.ParamForInitialApply" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        select
        <include refid="Base_Column_List" />
        from APPL
        where USER_ID = #{userId,jdbcType=VARCHAR}
          and ADMS_NO = #{admsNo,jdbcType=VARCHAR}
          and APPL_STS_CODE = #{applStsCode,jdbcType=VARCHAR}
    </select>

    <select id="selectApplByApplForInsertOthers"
            resultType="com.apexsoft.ysprj.applicants.application.domain.Application"
            parameterType="com.apexsoft.ysprj.applicants.application.domain.Application" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Aug 25 20:54:40 KST 2014.
        -->
        select
        *
        from APPL
        where USER_ID = #{userId}
        and ADMS_NO = #{admsNo}
        and ENTR_YEAR = #{entrYear}
        and ADMS_TYPE_CODE = #{admsTypeCode}
        and APPL_ATTR_CODE = #{applAttrCode}
        and DEPT_CODE = #{deptCode}
        and ARI_INST_CODE = #{ariInstCode}
        and CORS_TYPE_CODE = #{corsTypeCode}
        and DETL_MAJ_CODE = #{detlMajCode}
        <!--and INP_DETL_MAJ = #{inpDetlMaj}-->
        <!--and PART_TIME_YN = #{partTimeYn}-->
        <!--and KOR_NAME = #{korName}-->
        <!--and CHN_NAME = #{chnName}-->
        <!--and ENG_SUR = #{engSur}-->
        <!--and ENG_NAME = #{engName}-->
        <!--and RGST_NO = #{rgstNo}-->
        <!--and ZIP_CODE = #{zipCode}-->
        <!--and ADDR = #{addr}-->
        <!--and DETL_ADDR = #{detlAddr}-->
        <!--and TEL_NUM = #{telNum}-->
        <!--and MOBI_NUM = #{mobiNum}-->
        <!--and FAX_NUM = #{faxNum}-->
        <!--and MAIL_ADDR = #{mailAddr}-->
        <!--and APPL_ID = #{applId}-->
        <!--and APPL_STS_CODE = #{applStsCode}-->
        <!--and PRIV_INFO_YN = #{privInfoYn}-->
        <!--and CRE_ID = #{creId}-->
        and CRE_DATE = #{creDate}
        <!--and MOD_ID = #{modId}-->
        <!--and MOD_DATE = #{modDate}-->
    </select>

    <select id="selectApplByUserId"
            resultType="com.apexsoft.ysprj.applicants.application.domain.CustomMyList"
            parameterType="com.apexsoft.ysprj.applicants.application.domain.ParamForApplication" >
        select  a.APPL_NO, a.ADMS_NO, a.ENTR_YEAR, a.ADMS_TYPE_CODE,
                a.USER_ID, a.KOR_NAME,
                a.ADMS_TYPE_CODE, H.CODE_VAL ADMS_TYPE_NAME,
                F.CAMP_NAME, a.DEPT_CODE, b.DEPT_NAME,
                a.CORS_TYPE_CODE, G.CODE_VAL CORS_TYPE_NAME,
                a.DETL_MAJ_CODE, C.DETL_MAJ_NAME,
                a.APPL_STS_CODE, I.CODE_VAL APPL_STS_NAME,
                J.ADMS_FEE
        from  APPL a, DEPT b, DETL_MAJ C, COLL e, CAMP F, COMM_CODE G, COMM_CODE H, COMM_CODE I, ADMS_CORS J
        where 1=1
        AND a.DEPT_CODE = b.DEPT_CODE
        AND b.COLL_CODE= e.COLL_CODE
        AND e.CAMP_CODE = F.CAMP_CODE
        AND a.DETL_MAJ_CODE = C.DETL_MAJ_CODE
        AND a.CORS_TYPE_CODE = G.CODE
        AND a.ADMS_TYPE_CODE= H.CODE
        AND a.APPL_STS_CODE= I.CODE
        AND G.CODE_GRP='CORS_TYPE'
        AND H.CODE_GRP='ADMS_TYPE'
        AND I.CODE_GRP='APPL_STS'
        AND a.ADMS_NO=J.ADMS_NO
        AND a.DEPT_CODE=J.DEPT_CODE
        AND IFNULL(a.ARI_INST_CODE,'') = IFNULL(J.ARI_INST_CODE,'')
        AND a.CORS_TYPE_CODE = J.CORS_TYPE_CODE
        AND a.USER_ID =#{userId}
    </select>

    <select id="selectNewSeq" resultType="com.apexsoft.ysprj.applicants.application.domain.CustomNewSeq" parameterType="int">
        select a.ADMS_NO as ADMS_NO,
            a.DEPT_CODE as DEPT_CODE,
            a.CORS_TYPE_CODE as CORS_TYPE_CODE,
            max(APPL_ID_SEQ)+1 as NEW_SEQ
        from APPL a, APPL_ID_SEQ b
        where a.ADMS_NO = b.ADMS_NO
        and a.DEPT_CODE = b.DEPT_CODE
        and a.CORS_TYPE_CODE = b.CORS_TYPE_CODE
        and a.APPL_NO = #{applNo,jdbcType=INTEGER}
    </select>

    <update id="updateApplIdSeqIdByNewSeq" parameterType="com.apexsoft.ysprj.applicants.application.domain.CustomNewSeq">
        update APPL_ID_SEQ
        set APPL_ID_SEQ = #{newSeq,jdbcType=INTEGER}
        where ADMS_NO = #{admsNo,jdbcType=VARCHAR}
        and DEPT_CODE = #{deptCode,jdbcType=VARCHAR}
        and CORS_TYPE_CODE = #{corsTypeCode,jdbcType=VARCHAR}
    </update>

    <update id="updateApplByApplNo" parameterType="com.apexsoft.ysprj.applicants.application.domain.Application">
        update APPL
        set APPL_STS_CODE = '00020',
            APPL_ID = #{admsNo,jdbcType=VARCHAR}
        where APPL_NO = #{applNo,jdbcType=INTEGER}
    </update>
</mapper>